# MZ-700 S-BASIC 1Z-007BをMZ-80K_SD対応にするパッチ

　S-BASIC 1Z-007BはMONITOR 1Z-009A、1Z-009Bをコールしていないため、MZ-80K_SD対応にするためにパッチを当てる必要があります。

　S-BASICの仕様を把握してはいないのですが、試行錯誤の末、一応正常にMZ-80K_SDが動いていると思われますので公開します。

　たまたま動いているだけかもしれませんのでバックアップをとってからの実行をお願いします。

#### 2023.2.24 Ｏｈ！石様から「80K用の回路だと、MZ-700でRAMバンクが前に出た時にROMの出力と衝突します。S-BASIC/Hu-BASICがロードされたらRAMが前に出るので、700本体にストレスがかかります」との指摘がありました。その通りですのでこのパッチを使用する場合は「700本体にストレスがかかる」ことを承知の上使用してください。

## パッチプログラムについて

　SBASIC_patch1.bin、SBASIC_patch2.binの二つをS-BASICのMZTファイルに当てます。

　MZTファイルの00A1Hから00AFHまで(実アドレス0021H～002FH)をSBASIC_patch1.binと差し替えます。

　MZTファイルの5184Hから52E7Hまで(実アドレス5104H～5267H)をSBASIC_patch2.binと差し替えます。

　パッチを当てたファイルを「S-BASIC SD.MZT」等パッチを当てたことが識別できるファイル名で保存してお使いください。

　プロッタのCIRCLE命令をつぶしています。プロッタの他の命令に影響があるか検証していませんが、プロッタ関連の命令は使えないとしてください。

## ファイル名について

　オリジナル通りに16文字までがファイル名となりますが、半角カナ文字はArduinoが認識できない、一部の記号はMZ-700のキーボードから入力できないので使えません。

　ロングファイルネームに対応できなかった引き換えにLOADコマンドもオリジナル通りの入力方法となり、そのままDOSファイル名となります。

例)

　SAVE "TEST.BAS" : TEST.BAS.MZTというDOSファイル名で保存されます。

　SAVE "TEST"     : TEST.MZTというDOSファイル名で保存されます。

　LOAD "TEST.BAS" : TEST.BAS.MZTというDOSファイル名のファイルがロードされます。

　LOAD "TEST"     : TEST.MZTというDOSファイル名のファイルがロードされます。

　DOSファイル名が「TEST SBASIC EIGHT.MZT」の場合、LOAD "TEST SBASIC EIGHT"と入力しても「TEST SBASIC EIGH.MZT」というDOSファイルを探しに行くためロードできません。

## 使用方法
　パッチを当てたS-BASIC.MZTをFDコマンドでロードします。MONITOR 1Z-009A、1Z-009Bにパッチを当てる必要はありませんので、FT.MZTの実行も不要です。

## 追記
2021.12.26

　エラー処理のバグを修正。
