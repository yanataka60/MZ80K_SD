# MZ-700 TS-700をMZ-80K_SD対応にするパッチ

　「I/O別冊 WICS・BASEプログラム集」に掲載されているTS-700はMONITOR 1Z-009A、1Z-009Bをコールしていないため、MZ-80K_SD対応にするためにパッチを当てる必要があります。

　TS-700をMZ-80K_SD対応とすることで同誌に掲載されているSuperBASE-700、WICSインタプリタ・コンパイラもMZ-80K_SD対応となります。

　MZ-80K_SDは、本来80K用の回路ですのでMZ-700でRAMバンクが前に出た時にROMの出力と衝突します。このパッチをTS-700に使用する場合はMZ-700本体にストレスがかかることを承知の上使用してください。

## パッチプログラムについて

　APP_TS-700.bin(1465Byte)をTS-700.bin又はTS-700.mztの直後に連結して保存します。

　TS-700.binは5632Byteで連結すると7097Byteになります。

　TS-700.mztなら128Byteのヘッダが付いていますので5760Byteで連結すると7225Byteになります

　TS-700.binならヘッダをつけてMZTファイルにします。

![Header](https://github.com/yanataka60/MZ80K_SD/blob/main/TS-700/HEADER.jpg)

　TS-700.mztならファイルサイズと実行アドレスを修正します。

　TS-700起動時にSDアクセスルーチンは、F800h～に配置されます。BASE、WICSでプログラムを作るときにはF800h以降にオブジェクトを生成しないようにしてください。

## LOAD
　Lコマンドの後ろにはファイル名を指定せずに[CR]キーを押します。

　CMTの場合にはここでPLAYボタンを押すよう指示が出るところですが、「DOS FILE:」と表示して行入力待ちになっていますのでDOSファイル名を入力して[CR]キーを押します。この時、「.MZT」の入力は省略できます。

　DOSファイル名は「.MZT」を除いて32文字まで、ただし半角カタカナ、及び一部の記号はArduinoが認識しないので使えません。パソコンでファイル名を付けるときはアルファベット、数字および空白でファイル名をつけてください。

例)
× L TEST[CR]

○ L[CR]

　DOS FILE:TEST[CR]

### LOAD時の特殊コマンド
　「DOS FILE:」と表示して行入力待ちになったときに以下の特殊コマンドが使用可能です。

#### *FDL[CR]
#### *FDL x[CR]
　MONITORコマンド入力待ちからのFDL、FDL xと全く同等のファイル一覧機能が使えます。

　検索結果の行頭には「DOS FILE:」を付加して表示してあるのでLOADしたいファイルにカーソルキーを合わせて[CR]キーを押すだけでLOADが可能です。

　「*FDL」で検索、カーソルで選んで読み込もうとした場合に「DOS FILE:」に戻ってしまうアプリケーションがありますが、再度カーソルを合わせて[CR]すれば読み込めます。

## SAVE
　CMTの時と同様にアプリケーションの指定する入力方法、ルールでファイル名等を入力して保存してください。

　ただし、半角カタカナはArduinoが認識できないため、使用できません。アルファベット、数字および空白で指定してください。

　SAVE時は、入力したファイル名がIBFファイル名、DOSファイル名の両方に適用されます。

　DOSファイル名としての「.MZT」は自動的に付加されます。

例)

○ S8000,8FFF,8000,TEST[CR]

## BASE、WICSでのLOAD、SAVE

TS-700での扱いと同様にLOAD時にはファイル名を指定せずにDOS FILE:と聞かれたらDOSファイル名を指定します。

SAVEはBASE、WICSのSAVEの仕方と同様です。半角カタカナは使えません。入力したファイル名はIBFファイル名、DOSファイル名の両方に適用されます。

　DOSファイル名としての「.MZT」は自動的に付加されます。
